# Architecture

> Auto-generated by /map on 2026-02-05

## Overview

BedwarsStats is a Minecraft 1.8.9 Forge Mod designed to enhance the Hypixel Bedwars experience. It provides real-time player statistics, threat analysis, and automated tools like bed proximity warnings/autoplay.

```
┌─────────────────────────────────────────┐
│              [Entry Point]              │
│            ExampleMod.java              │
│      (Event Bus, Commands, Ticks)       │
├─────────────────────────────────────────┤
│         [Business Logic Layer]          │
│   HypixelAPI (Async), AutoPlay,         │
│   BedProximity, Stat Rendering          │
├─────────────────────────────────────────┤
│            [Data Layer]                 │
│    PlayerDatabase (History/Blacklist)   │
│    BedwarsStats (Data Model)            │
│    ModConfig (File Config)              │
└─────────────────────────────────────────┘
```

## Components

### Core Mod (`com.imshy.bedwars`)
- **Purpose:** Main entry point, event handling loop, and UI rendering.
- **Location:** `src/main/java/com/example/bedwars/ExampleMod.java`
- **Dependencies:** Minecraft Forge API, HypixelAPI, PlayerDatabase.

### Hypixel API Handler
- **Purpose:** Async Fetching of player statistics from Hypixel API/Mojang API. Handles rate limiting and caching.
- **Location:** `src/main/java/com/example/bedwars/HypixelAPI.java`
- **Dependencies:** `java.net.HttpURLConnection`.

### Storage & Config
- **PlayerDatabase:** Persists encounter history and blacklist (Location: `PlayerDatabase.java`).
- **ModConfig:** Handles configuration loading/saving (Location: `ModConfig.java`).

## Data Flow

1. **Trigger**:
   - **Chat Logic**: Detects "Protect your bed..." -> Activates Lobby Mode.
   - **Entity Join**: Player joins world -> Triggers Stat Lookup.
   - **Tick**: Checks bed proximity / Autoplay queue status.

2. **Processing**:
   - `HypixelAPI` checks cache. If miss -> Mojang API (Name to UUID) -> Hypixel API (UUID to Stats).
   - Stats processed into `BedwarsStats` object.
   - Threat level calculated.

3. **Output**:
   - **Overlay**: Draws stats list on screen (`onRenderOverlay`).
   - **Nametags**: Renders threat level above players (`onRenderLiving`).
   - **Chat**: Warnings/Info printed to local player chat.

## Integration Points

| Service | Type | Purpose |
|---------|------|---------|
| Hypixel API | REST | Fetch Bedwars statistics |
| Mojang API | REST | Resolves Username to UUID |

## Technical Debt

- [ ] **Package Naming**: Source files are in `com.imshy.bedwars`, but build.gradle uses `com.imshy.bedwars`.
- [ ] **API Parsing**: Manual JSON string manipulation loops in `HypixelAPI` (fragile) instead of full Gson mapping.
- [ ] **Hardcoded Strings**: Chat detection relies on specific string literals which may break if Hypixel updates messages.
- [ ] **Data Persistence**: `PlayerDatabase` implementation details (JSON/Flatfile?) need verification for scalability.
